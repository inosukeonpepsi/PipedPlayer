<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Doug's YouTube Player - Ad Skip Mode</title>

<style>
  body{background:#071020;color:#e6eef8;font-family:sans-serif;padding:20px;}
  .player-wrap{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;background:#000;}
  #player{position:absolute;top:0;left:0;width:100%;height:100%;}
  input[type="text"]{width:300px;padding:6px;border-radius:4px;}
  button{padding:6px 10px;border-radius:4px;}
</style>
</head>
<body>

<h1>Doug's YouTube Player - Ad Skip Mode</h1>
<input id="videoInput" placeholder="YouTube URL or ID" />
<button id="loadBtn">Load</button>

<div class="player-wrap">
  <div id="player"></div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player;
let lastTime = 0;
let currentVideoId = '';

function extractVideoId(input){
  if(!input) return null;
  input=input.trim();
  const idRegex=/^[a-zA-Z0-9_-]{6,}$/;
  if(idRegex.test(input)) return input;
  try{
    const url=new URL(input.indexOf('http')===0?input:'https://'+input);
    if(url.hostname.includes('youtu.be')) return url.pathname.slice(1);
    if(url.searchParams.has('v')) return url.searchParams.get('v');
  }catch(e){ const m=input.match(/v=([a-zA-Z0-9_-]{6,})/); if(m) return m[1]; }
  return null;
}

function onYouTubeIframeAPIReady(){
  player = new YT.Player('player', {
    videoId: '',
    host: 'https://www.youtube-nocookie.com',
    playerVars: {playsinline:1,rel:0,modestbranding:1},
    events: {onReady:onPlayerReady, onStateChange:onStateChange}
  });
}

function onPlayerReady(){
  document.getElementById('loadBtn').onclick = () => {
    const id = extractVideoId(document.getElementById('videoInput').value);
    if(!id) return alert("Invalid video ID/URL");
    currentVideoId = id;
    player.loadVideoById(id);
  };

  // Track time every 250ms
  setInterval(()=>{ if(player && player.getPlayerState() === YT.PlayerState.PLAYING) lastTime = player.getCurrentTime(); }, 250);
}

function onStateChange(event){
  // Detect unexpected pause/buffering (often caused by ads)
  if(event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.BUFFERING){
    // If we are mid-video and video is paused unexpectedly, resume
    if(lastTime > 0){
      player.loadVideoById({videoId: currentVideoId, startSeconds: lastTime});
    }
  }
}
</script>

</body>
</html>
